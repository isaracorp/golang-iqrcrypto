// Copyright (C) 2020, ISARA Corporation
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// +build cgo

package iqrcrypto

import (
	"crypto/x509"
	"encoding/pem"
	"log"
	"testing"
)

// Self-signed hybird certificate (Dilithium)
var hybridDilithiumCert = `
-----BEGIN CERTIFICATE-----
MIIUTjCCEzCgAwIBAgIJANBBz8JZWu3QMA0GCSqGSIb3DQEBCwUAMGMxCzAJBgNV
BAYTAkNBMQswCQYDVQQIDAJPTjEPMA0GA1UEBwwGT3R0YXdhMREwDwYDVQQKDAhD
cnlwdG80QTEMMAoGA1UECwwDRW5nMRUwEwYDVQQDDAxjcnlwdG80YS5jb20wHhcN
MjAwNDI4MTc1NjQ2WhcNMjEwNDI4MTc1NjQ2WjBjMQswCQYDVQQGEwJDQTELMAkG
A1UECAwCT04xDzANBgNVBAcMBk90dGF3YTERMA8GA1UECgwIQ3J5cHRvNEExDDAK
BgNVBAsMA0VuZzEVMBMGA1UEAwwMY3J5cHRvNGEuY29tMIIBJzANBgkqhkiG9w0B
AQEFAAOCARQAMIIBDwKCAQY9Zb6zbt11X+MnbFbID5GkcKm8P+qZ84l8u8GXL8e7
2b+bxcSaQNHf6RHkyNAj59VZFFLlWEMV3YRnPpcJqxE9W4qEetzbwmpF0swn7NGI
AmXuW63/sRnO7bSKSpmzBS+y88vZN/XHf+wAf+E2fxDDNWyhR90VrXMOMoaTFHCS
QBSy2MFITCb+A3wmjoi7E7mgxgY7xRSKac3L2r7J9vXsd8AF94mU94Gpo99rUPy9
JyBAZPZs82SQdHu1JNnRIOSdYZKsCxG9ERp/xOmkyK9Gt3Rq55oetXo+5xQoC88K
yJed8csqV51qI52rqngxD4MOKwdOUsI+0cW0Hn8Jq12MNEqzXsznAgMBAAGjghD4
MIIQ9DAdBgNVHQ4EFgQUeGOFjf9F5Ou1DeC5dRTjO0X5Sn4wHwYDVR0jBBgwFoAU
eGOFjf9F5Ou1DeC5dRTjO0X5Sn4wDAYDVR0TBAUwAwEB/zAUBgNVHUkEDTALBgkE
AH8ADwEBCQAwggXtBgNVHUgEggXkMIIF4DAVBgkEAH8ADwEBCQAGCAQAfwAPBgkB
A4IFxQAEggXAv0GXbjhtkhEHi0ViaPXWG82wwugrbSwiSfccwVBVHMABnQNR/Eps
pPUJ1mEG8etDNyc/XFeIBGa85dsfiozikO/HaZ3ZAtaWLuDWtCVuSciCVkxS8Nwv
xw9dcwMhVLLtGwAxmetBhmhNmSiFZAz7AWPahPvCbL0a4XkkudteYYnxWCvSazP+
iY/al9gf+sicvXdzcwc4Qn9pbr1xwQQt0vthrv2kgtOaPpofaWE9jM6B0phufSLx
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
V9avbh4gLs2QPlmOWsuJDXeg
-----END CERTIFICATE-----
`

var hybridHSSCert = `
-----BEGIN CERTIFICATE-----
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
-----END CERTIFICATE-----
`

func TestVerifyHybridCertificate(t *testing.T) {
	var ctx *IqrContext

	err := IqrCreateContext(&ctx)
	if err != nil {
		t.Fatalf("IqrCreateContext error: %s\n", err)
	}
	defer IqrDestroyContext(&ctx)

	// Dilithium self-signed certificate

	block, _ := pem.Decode([]byte(hybridDilithiumCert))
	if block == nil || block.Type != "CERTIFICATE" {
		log.Fatal("failed to decode hybrid certificate")
	}

	cert, err := x509.ParseCertificate(block.Bytes)
	if err != nil {
		log.Fatal("error parsing hybrid certificate")
	}

	err = CheckAltSignatureFrom(cert, cert)
	if err != nil {
		log.Fatal("CheckAltSignatureFrom failed")
	}

	// HSS self-signed certificate
	block, _ = pem.Decode([]byte(hybridHSSCert))
	if block == nil || block.Type != "CERTIFICATE" {
		log.Fatal("failed to decode hybrid certificate")
	}

	cert, err = x509.ParseCertificate(block.Bytes)
	if err != nil {
		log.Fatal("error parsing hybrid certificate")
	}

	err = CheckAltSignatureFrom(cert, cert)
	if err != nil {
		log.Fatal("CheckAltSignatureFrom failed")
	}
}

var pureDilithiumCert = `
-----BEGIN CERTIFICATE-----
MIIR3jCCBzugAwIBAgIJAKMXGkbjgRSsMAsGCQQAfwAPAQEJADBiMQswCQYDVQQG
EwJDQTELMAkGA1UECAwCT04xETAPBgNVBAcMCFdhdGVybG9vMQwwCgYDVQQKDANF
bmcxDDAKBgNVBAsMA0VuZzEXMBUGA1UEAwwOaXNhcmEtdGVzdC5vcmcwHhcNMjAx
MDA3MTcwODUwWhcNMjExMDA3MTcwODUwWjBiMQswCQYDVQQGEwJDQTELMAkGA1UE
CAwCT04xETAPBgNVBAcMCFdhdGVybG9vMQwwCgYDVQQKDANFbmcxDDAKBgNVBAsM
A0VuZzEXMBUGA1UEAwwOaXNhcmEtdGVzdC5vcmcwggXgMBUGCQQAfwAPAQEJAAYI
BAB/AA8GCQEDggXFAASCBcC/QZduOG2SEQeLRWJo9dYbzbDC6CttLCJJ9xzBUFUc
wAGdA1H8Smyk9QnWYQbx60M3Jz9cV4gEZrzl2x+KjOKQ78dpndkC1pYu4Na0JW5J
yIJWTFLw3C/HD11zAyFUsu0bADGZ60GGaE2ZKIVkDPsBY9qE+8JsvRrheSS5215h
ifFYK9JrM/6Jj9qX2B/6yJy9d3NzBzhCf2luvXHBBC3S+2Gu/aSC05o+mh9pYT2M
zoHSmG59IvF5ykczVcurY7uebPENw68aARuQtybXWxp2qNi3XH4izJ4B/PFj9uPe
3ltDTWtTkQUlq9qC1AO1Y1tvuLQNPhsu3Ru9kT6ZnwJoyBC2WsOOIDQGQ/uNyjWP
nCU76DKgT3Ihrzqisvgo5BMbpTZrqvPJxTDsYPgD+0RFpDdDTQ2eGdmmfb/GmdVd
qTAsa83vzunTvwpg4fl595ssUq5kb5tXbvCtQs/tj5kpPMo0YqZRSvf9F69qzuSi
IubHeeXncwV6kAfz3+/yf6i468W0pJ/KvpfIgcnGZQHtrmbEVbzdDidT3m24buWB
Fer4CgFdiZ3CTH1JShZ0MR/XnF41bODZAWb05l2oJtlHBA0kKQTQsEFeWE+x2nuL
muO0ScDYYD/Ozou89UZmpry2qCXxAS1AMz9Iu/dRsH6NAgpEfVBCjgSyggKtCrL9
ZaKs2A6r4PuH4TNnpo9wJC/F+BWEoM/Ur5xvYRyek88YPk8nWpF5C4/oUdefgldF
LcIikJBbF870wXFuEiWuWeqDCF3wTFetjg0MsAxwBQFz7JiX9pfNZTtwdwOm9z4V
tH2zmxpvE0Eb6ZFAoYzbwv8klto0x75pXoQqnoVI19yABslo4azvpAvlgZrgBHC+
IQ1cwhF63RlWkygmoCIXHXEzRMli9Vq+W8tzAm0MLEYrHWv5GLrF/wdMwprXwsRi
3q5pWZn7jgNis2T3hRHrFRHfs0MWsCRgcwjPx7rRgJbtp2gv0dv76m1mqKfhhm+9
Lw2Z2dEP+QSKeDgIxuWU6wKSnpo3hnnCzdnieWCgUYE/wbF3UZBGgveAfLxPMR9s
fJESuFM4la1oHrohWY8bc97+CiHNSdfhNKfrvgiYtd54QVmqdPlHkVSsePJA7egX
WpFq9LDtpiB1DSODbF6NmUpCVSHDhhWNYcvUfZCW7JbIDe7LkkiJifL7nuh+nj93
EIQINWNRs8OtrUruU1xBFiGKK8L7vLTis7e6bBI51MUYA4HKUlSttGFlTtPUjtV5
Il16nayeHpBZfsoO5XuiohfHZCIH0zyvHfcWKJzyuSrl6zsQW5GDYSe+hftr46FH
Bj8Xdza+WPv1cT5yEEGHOw7BtF6gIozpoYfGYvT2EvBls1BAIyYwYb51h6dLL4fp
WPhNF/yA8lgAzmkzr2iOQDHPFbXON1K4Im4K5b3pVONMpYkdxpS3RAr79A708u7X
r/TD8KgdPCuqbRxa4sXjP90IYoOEo4JhcsisQuPmW4klgXyxwWl+qsMxAtikAb3p
qVrx3PBXFAD2f5B+FVe+2LBl6/FbTAqOeTEAg4EhoX1cMbZtVFu7U3sZ60sn6xLG
uzPSGS+BX48MZniTZQgSxwOLUPxrP0mOYlJSflwPpXusXsrME93V7iaei9i53rMB
mv6xRpiQBSLM+7gfY2+DKbs054wW69kL6Mp1Nw3plEVLh59aGAAbRbZgHAGNNnb7
w9LmW01Opqfv2OjNvNAfKPqjpGVkKCQCPZDPIoj2BC5VPamihOjZ7s9/ygAeUDtj
tEGzIlHRrdrThEVVRiYTp2RKERnfK795jhfgOdgOKIdNVG8r8gEittVGWrI6wajY
xULfkaOE00VMaYJRj0i8LtAp1eRcTvAwO0dcc7pYnfMckRiooRg0r4Rwci14JvzT
R3xprlGiS0EkOtM04soa9a8/DapIfK7Mo7zkQdZxh1u/J0BA9xxFjsQ3zICHDq+r
NaNQME4wHQYDVR0OBBYEFBdXF8MYBb3G4JXbulIGgzBz/glfMB8GA1UdIwQYMBaA
FBdXF8MYBb3G4JXbulIGgzBz/glfMAwGA1UdEwQFMAMBAf8wCwYJBAB/AA8BAQkA
A4IKjgCin7aywelYF8ubqpBX/Zq2l7vB1jaFZICVIqfZPhJtzlypuoAGgYg4uROA
kocE1J1nAzKCyhbmps6doMhznkAQniwCMLLF7uDK8mUW0ZXHFqEupfzJJg3ETy1T
zOWKnj1XCbt3Gck7TAFVqjzMPlrRINvsbMVtcD+1E+pLLYC47NtNM/41BwKchCjr
nGCfjoaEyw7pJSuqmCwvj40cSe6uQIiJpXMyHzhbLG56sA9fVarJNzVmWBMMSCE0
bIrAEl9DkiJ9H/AaC3Oo4IIPJv1MGOXvQf59FHZFBHEOfGV5s0XAVzifqaEz04Un
QE7jh3b2NUFenOiLdM4tWVLVHzAN6Tx1Eo5X2xn1zNzBo86QAYahOMO6dMT4iPsN
rZr63GRYDRzj+/3vQlx6dQIiH/dafOD+TKNevNo13ZP/hf/Sm/lfgEsH3ITJ1ik2
QU2hePb97I2zMvdxLT7Qm61uBxbJJiFBtHOzvrIVm4E68w4vOSMCyr/Ht86ra7GD
/Gmh8G0m0gmVOdwHULe8M5aLY9rFLz13FdgxRJf5WoCLTpvOB5eotdyOnvJeUo8p
i0tytRZN9xqE0HXcWE/o4yq+siWHbIEgRJiCvd+q1x1AukBTy70zrTLnNzHgcxmD
VpoQuY5hghVkaiM59NrustlFCyNH6C+bKO+MIaVdX5q0aK7NhlSYX1DVPA/bI5/6
fO9z5u9oGITFR/0VuD99t8PjC0Fud9KoswQBnx4Y0Gq5kF03/EctVYlY0CLctIn4
ssXfxq6i9D9f8vvZkg9fPdWQ65YF/trHXW9dDC2xtKtRasa1F0/Q/orsRj9IV4q/
PtIewnur34wfPOvvkJfHmaVrwsebuiYaKJLKnMwNGa5FVOZfj91YrkepqzA/VD7T
42JMUCeNhkntEBzvC2kZuVT7bDqktBndkymDpprjxGiafenZMf1S7etyLg1klD0Q
S9O3sbb1Qov4ew4YUVLUMKMhlv1xo+TtDPpFEc9jAQmouoW3gkocR+PH6uHgApHw
/5UMGcJGRRzqy/s86kNg56KciIxhSXfRnjaapjn7Vam5opdGEIaOdTRd16Jc+SuF
erJmUiLMpzXi4aodqsRaQ3SqRGC5I1FcbGWTHgxeBv5HYJe7afPuTWl+gtwdssw0
Qhtfakn/mqFtUFbxe4/Xtzflu2848J1kbx5Xd1doL5Dhq2Dg7twdLTLmR3DBgSJE
uodyVNNmjCF/Kx7aZ58wUu3d5vMRw9AlVPOznxwEBVYwccPK3z6zJDxz5NU7F41c
XRAZHhZvtbOkMRx99MeXsby/F93pwG77BIbdaGfO/sVXnNAV8oB6zt99xS8Fl1hu
YKL1NU34nFp7YEnkhhkKq2kAMiWoyawq3bWx910lnpFj3U1i+5NYl/ZftUXp22Vd
odAfOwlUZGSTS0NhM0APR21MsZEyR59Vvp1WJBf9tCVAy5VNtnO7z69I98gXq1C/
J/5yDhOjJE6XPwRjrE7ThWf8jaqBHEBNuJZQEWprIRhym2Qfj8K33FD6icLgRgSZ
5njjO8+Ubv2jKp7RdXkE6ssXsCzgeCENBw/jSnD8zZtoHWduzfX5RsRw5XKASuBX
vLhon6mJC+ioIC/UzpRb04rjDJc1vpNS95CJDNucOfeVks8g9GBzDbltoH5QFa0j
mpIEVaJP0Gc8tWZw29FLoreVfuopANWqdpxLhm4Zkj7dOncKkEs57vlY10ex6t3k
Io87PoecizQtjO5UjiP16ahweq8BTx1+FhcygPEjam2ustCtyHvEuUbQhPjfwr/Z
IP0BVD3E190MnBRD0f/mzUBUBfo//6B5bnElMBIokhfe7V9fLPRsnETCfK0OZlro
Vwiu5mnJAxOkymp1o13EXGB88qPuZuAvg9uWPwXLv3m4LScCGeDaFw0aF/R81EO7
CZt1vyiSkzwnvly8VelRfXR/0ATH/LlyrQy7yay/8n9wW4a8cjzusFCq9cGrFyTl
gXboGiPAq6cMWCqy+i0JN9wvBEkbbcGmitURr/HMZCIK6G3IlEXN1By854B+TUjL
OV+PvO78Er+S9ZmrjYPlHNY+jOTrkqR/CftrXldFvnywCe/eUuF7FU+U6aZVpky0
wGIHZUGvdRiXmNNIG//QIJ0e184ZV0Gb/RN1Ma/Lkt0/ibt25kjIwhQImWZWUyLX
0B5+lZv1F7vrs/llVbYkMbEeb4/fRCPh21e4BMaNjUhTua3+K5RPNuFovENJkxFV
X/EYCCJ4ERam3WnBFpFTqmjIBiE1IpQEEnoQ35jTeR7CmHbLIcHMTpqIW/sXGA50
lbEG2Pukm8yyTrI3EKOU0P5MgNP6SOhGcy1I0e/gnK61VDsUxd3TRS7GZ4GPXk0a
tntcK+mgFNlqpMRxgVTXOPx3Bo4pK+DsH28aPo3Y00sq9qEj+Hr5zpKOmlOhxiBI
l7Mlz7KL5hVjoUjOJzCkpK8/342GF2zWNgQWnfr1AOJfEBfPTyXi17E2eVYaoYbm
A9ztTUDvt3F1C/sgp4nym3iAhHTQtBL+Dz7ztFyGTaImpXd+dajgq/UvN/HaPCDf
5QD6FBhFh8BO/YqWiWtYc3Pm+4l2//jv3WA44xAst72ivciwG6aWPvD3tTEE/sa1
bBODnloic7b4pydvv0f04Srcw5IKHez3ZGQib/+GHy5O1QdGZaygt4Rp9ITDBgyk
bozCoiqaqK+sJaQwPZT8tO66ei7MD0bkRfAZV2FSvypl2ksuSPQYRlx0Cv4YpOEs
2IXn8HnNWr0Bje4HZ30HEPQTbO8LKlx1XoUMo76McA1HGVRDZfV7jBnFd+NQEVdG
/8CVPKFJNzKLwx/USUMrQw36t/cxSMix5Oxbf/xyRcTD5565kMMJhIevSYd4BJb4
hDdyjOGnEGusWRru/Y/B2fx2uizpuquz6iWYjOOHg9p6y9Wa/+A6TcLc1Vf7VYfw
IMSWXaunVS9fs6bwZKPQaj+tH+oQkdkgGMT1Y5tiXEowGleWjrOy1JYta/8Y2Grr
J4Uh9SEnjQ8B+SAUrpLVcwTvQ1Wm1QjuWyN6CeKzbPqqhriG2GanX4ogrq9IK/CL
cl6JmJ1cmEAIceItN+FWEJRsllwEC9ZSgGeKA2k4RPCSCISC9i/ScAv84ejMeV2L
LuO3/T0iVwZffnQfAvvFl86QaucxcJQOZTu+ODkFnWu50V4O74rOEHTHf8DfVu2C
Qo5Ixl0ndzZ0UIc7ukmUPhiLgqAWndh2LlEkE9jRrsno+prCm5nnZSgZsI3YOtKB
N5V/sr9Hzc/gGRjjXd+3D/5eYjEjFP5n/3LFvDdPGDhKUh9f8Udnsoe9Jgl4+8hd
K5mozeh4TNGB8fzIrNt7uzHVuOY7Xe1omMPmeUe5wGRKlmtFnUQGhCLR18PtohvO
/Vleo02VmVOJvXWvpouVmiSxcpieFBwlNEJWXF1kZ3uDmJmmq6/J1fT8/QlGSlNh
aXR8gpmc6PIKKzpPVnqRlJ3DzNDY4RIYKj5QU1VdZoaXrb7L9QwNGSp5gISFkZqd
n6SuvMXK2N/rAAAAAAAAAAAAAAAAFiMxQFQQgAgAACcAgAggvQEBQgMACIUAYso1
QBJlMAiMVQRLEBu9H2yo/+IF
-----END CERTIFICATE-----
`

func TestQSVerifyDilithiumCertificate(t *testing.T) {
	var ctx *IqrContext

	err := IqrCreateContext(&ctx)
	if err != nil {
		t.Fatalf("IqrCreateContext error: %s\n", err)
	}
	defer IqrDestroyContext(&ctx)

	// Dilithium self-signed certificate
	block, _ := pem.Decode([]byte(pureDilithiumCert))
	if block == nil || block.Type != "CERTIFICATE" {
		log.Fatal("failed to decode hybrid certificate")
	}

	cert, err := x509.ParseCertificate(block.Bytes)
	if err != nil {
		log.Fatal("error parsing hybrid certificate")
	}

	err = CheckQSSignatureFrom(cert, cert)
	if err != nil {
		log.Fatal("CheckQSSignatureFrom failed")
	}
}

var pureHSSCert = `
-----BEGIN CERTIFICATE-----
MIIg5zCCAa+gAwIBAgIJAO/eopYQTL/5MA0GCyqGSIb3DQEJEAMRMGQxCzAJBgNV
BAYTAkNBMQswCQYDVQQIDAJPTjERMA8GA1UEBwwIV2F0ZXJsb28xDjAMBgNVBAoM
BUlTQVJBMQwwCgYDVQQLDANFbmcxFzAVBgNVBAMMDmlzYXJhLXRlc3Qub3JnMB4X
DTIwMTAwNzE3MjEwM1oXDTIxMTAwNzE3MjEwM1owZDELMAkGA1UEBhMCQ0ExCzAJ
BgNVBAgMAk9OMREwDwYDVQQHDAhXYXRlcmxvbzEOMAwGA1UECgwFSVNBUkExDDAK
BgNVBAsMA0VuZzEXMBUGA1UEAwwOaXNhcmEtdGVzdC5vcmcwUDANBgsqhkiG9w0B
CRADEQM/AAQ8AAAABQAAAAYAAAAE5+TSvmUXWWh4XuIy7eEbJAThoLqXMXATTk8u
pjLjaEhS8sqOtfDNNLzLOETTC5rno1AwTjAdBgNVHQ4EFgQUla+mrYRdH5ZZ2s5I
oAjLeMxwk5IwHwYDVR0jBBgwFoAUla+mrYRdH5ZZ2s5IoAjLeMxwk5IwDAYDVR0T
BAUwAwEB/zANBgsqhkiG9w0BCRADEQOCHyEAAAAABAAAAAAAAAAEpCiI3AiHSe4H
zorP5m91QTclNavNFwltnfmTToKNPf+vxxGXIOatKphxQpXbLYfTb8dLIhTXWPDB
TkDadz+TVShRLkh3pYsO39HXijOYDws3OVtVzADxaLVe5cIhXngNuLnZbLG3MNGt
9bPy7KKQVYYBNw7ZNlHQoPwc/gzxPE5gz4tL1yOdLXwlMm5sJM1ImxPECDsFCCbi
5XHYhBTheWlR00ly4rQav58ZDi7um2Q77L/tVsjN9jOovdOmXTDEs2R2z0uneaaM
6QN5o4G+EdLtH1I0qDeBH43+4OtzwDHq7/4eEkR8+GKhOg0Kp0IKQw58gpIm6ja5
b1Ftb5eUEN/1mX0GN7m9fdBEcj9BkvtGSe6253BiVBerwNT95sN2ob/0rl87RybQ
+1uSSy9vvbO3vVNtMGNIxcvJ1FobSR51VmF5CR6q0nyJlh2zNDDXDohkswac4ZpX
N1v0PYQ4PKbU60Bpx+FpMp9snO7mjmkD+fa78foQX4hipIjfu5Kncs1rzoIKLwCY
NPaBYraCh8Gc4F2gOGTPufqAGGTPGoEOxXAobVgZyRysXVSGjQAMGPEzxkqCfncL
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
9DDfGUJupaUsbcmJ31QMA5hlAHYmYmofF6rk
-----END CERTIFICATE-----
`

func TestQSVerifyHSSCertificate(t *testing.T) {
	var ctx *IqrContext

	err := IqrCreateContext(&ctx)
	if err != nil {
		t.Fatalf("IqrCreateContext error: %s\n", err)
	}
	defer IqrDestroyContext(&ctx)

	// HSS self-signed certificate
	block, _ := pem.Decode([]byte(pureHSSCert))
	if block == nil || block.Type != "CERTIFICATE" {
		log.Fatal("failed to decode hybrid certificate")
	}

	cert, err := x509.ParseCertificate(block.Bytes)
	if err != nil {
		log.Fatal("error parsing hybrid certificate")
	}

	err = CheckQSSignatureFrom(cert, cert)
	if err != nil {
		log.Fatal("CheckQSSignatureFrom failed")
	}
}
